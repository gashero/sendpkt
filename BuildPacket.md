# 如何构造数据包 #

SendPkt负责发送链路层数据包，目前只在以太网内做了测试。

为了发送数据包，首先你需要有一个完整的可用的数据包，即以太网帧。构造数据包推荐使用dpkt。使用dpkt可以构造和解析数据包。

另外，构造数据包时，你还需要充分的了解数据包的各个字段函数与协议栈结构。

对ARP协议来说，底层只有以太网帧。对IP协议来说也是一样。但是对于更高层的协议来说，比如TCP，则由IP->Ethernet两层的底层，并且顺序不可改变。使用dpkt构造数据包时也要按照相同的顺序依次构造，从高层协议开始，依次向底层，每次都把上层数据包作为下层协议的data字段。

当然，sendpacket()函数接受的是字符串形式的数据包，所以如果你可以自己构造数据包也未尝不可。

再次向自己写数据包内容的牛人致敬！